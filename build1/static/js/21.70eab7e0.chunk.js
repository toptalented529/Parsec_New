(this["webpackJsonpparsec-frontend"]=this["webpackJsonpparsec-frontend"]||[]).push([[21],{1096:function(e,t,c){var n=c(471),a=c(472),r=c(228),s=c(102),i=c(167),o=c(286),j=c(288),l=c(287),b=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(i(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||l(e)||r(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(j(e))return!n(e).length;for(var c in e)if(b.call(e,c))return!1;return!0}},1172:function(e,t,c){"use strict";c.r(t);var n,a,r,s=c(14),i=c(2),o=c(6),j=c(10),l=c(12),b=c(0),d=c(4),u=c(824),O=c(89),h=c(808),x=c.n(h),p=c(1096),m=c.n(p),f=c(418),v=c(53),g=c(165),y=c(21),T=c(35),D=c(852),k=c(179),C=c(31),w=c(783),S=c(423),B=c(227),P=c(941),I=c(836),M=c(793),Y=c(909),q=c(11),A=c(5),E=c(1),z=A.e.label(n||(n=Object(q.a)(["\n  color: ",";\n  display: block;\n  font-weight: 600;\n  margin-bottom: 8px;\n"])),(function(e){return e.theme.colors.text})),H=Object(A.e)(z)(a||(a=Object(q.a)(["\n  font-size: 20px;\n"]))),L=Object(A.e)(z)(r||(r=Object(q.a)(["\n  font-size: 12px;\n  text-transform: uppercase;\n"]))),F=function(e){var t=e.children;return Object(E.jsx)(d.sb,{color:"failure",mb:"4px",children:t})},R=function(e){var t=e.errors;return Object(E.jsx)(d.j,{mt:"8px",children:t.map((function(e){return Object(E.jsx)(F,{children:e},e)}))})},V=c(34),J=c(194),K=c.n(J),Q=c(67),W=["onRemove","onTextInput"],G=function(e){var t=e.onRemove,c=e.onTextInput,n=Object(Q.a)(e,W),a=Object(b.useState)(!1),r=Object(l.a)(a,2),s=r[0],i=r[1],j=Object(b.useState)(!1),u=Object(l.a)(j,2),O=u[0],h=u[1];return Object(E.jsxs)(d.j,{position:"relative",mb:"16px",children:[Object(E.jsx)(d.O,Object(o.a)(Object(o.a)({},n),{},{onChange:function(e){var t=e.currentTarget.value;i(O&&0===t.length),h(!0),c(t)},isWarning:s})),t&&Object(E.jsx)(d.j,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:Object(E.jsx)(d.M,{variant:"text",onClick:t,children:Object(E.jsx)(d.B,{})})})]})},N=function(){return{id:K()(),value:""}},U=function(e){var t=e.choices,c=e.onChange,n=Object(C.b)().t,a=t.filter((function(e){return e.value.length>0})).length>=2;return Object(E.jsxs)(d.p,{children:[Object(E.jsx)(d.s,{children:Object(E.jsx)(d.K,{as:"h3",scale:"md",children:n("Choices")})}),Object(E.jsxs)(d.q,{children:[t.map((function(e,a){var r=e.id,s=e.value;return Object(E.jsx)(G,{scale:"lg",onTextInput:function(e){var n=Object(V.a)(t),a=n.findIndex((function(e){return e.id===r}));n[a].value=e,c(n)},placeholder:n("Input choice text"),value:s,onRemove:a>1?function(){c(t.filter((function(e){return e.id!==r})))}:void 0},r)})),Object(E.jsx)(d.l,{type:"button",onClick:function(){c([].concat(Object(V.a)(t),[N()]))},disabled:!a,children:n("Add Choice")})]})]})},X=c(323),Z=c(770),$=c(748),_=function(e,t){if(!Object(X.default)(e)||!Object(X.default)(t))return null;var c=Object(Z.default)(e,"yyyy-MM-dd"),n=Object(Z.default)(t,"HH:mm:ss");return Object($.default)("".concat(c,"T").concat(n)).getTime()/1e3},ee=c(795),te=c(166),ce=c(912),ne=c(911),ae=function(e){var t=e.block,c=e.onDismiss,n=Object(C.b)().t,a=Object(b.useState)(!0),r=Object(l.a)(a,2),s=r[0],i=r[1],o=Object(ce.a)(t,s),j=o.isLoading,u=o.total,O=o.cakeBalance,h=o.cakeVaultBalance,x=o.cakePoolBalance,p=o.poolsBalance,m=o.cakeBnbLpBalance,f=Object(te.a)().theme;return Object(E.jsx)(d.W,{title:n("Voting Power"),onDismiss:function(){i(!1),c()},headerBackground:f.colors.gradients.cardHeader,children:Object(E.jsx)(d.j,{mb:"24px",width:"320px",children:j?Object(E.jsx)(d.I,{height:"450px",alignItems:"center",justifyContent:"center",children:Object(E.jsx)(d.ob,{size:80})}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(ne.a,{total:u,cakeBalance:O,cakeVaultBalance:h,cakePoolBalance:x,poolsBalance:p,cakeBnbLpBalance:m}),Object(E.jsx)(d.l,{variant:"secondary",onClick:c,width:"100%",mt:"16px",children:n("Close")})]})})})},re=Object(b.lazy)((function(){return Promise.all([c.e(12),c.e(23)]).then(c.bind(null,1164))}));t.default=function(){var e=Object(b.useState)({name:"",body:"",choices:x()(2).map(N),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}),t=Object(l.a)(e,2),c=t[0],n=t[1],a=Object(b.useState)(!1),r=Object(l.a)(a,2),h=r[0],p=r[1],q=Object(b.useState)({}),A=Object(l.a)(q,2),z=A[0],F=A[1],J=Object(C.b)().t,K=Object(O.c)().account,Q=Object(f.a)(),W=Object(u.a)().push,G=Object(y.a)().library,Z=Object(g.a)(),$=Z.toastSuccess,te=Z.toastError,ce=Object(d.Gb)(Object(E.jsx)(ae,{block:c.snapshot})),ne=Object(l.a)(ce,1)[0],se=c.name,ie=c.body,oe=c.choices,je=c.startDate,le=c.startTime,be=c.endDate,de=c.endTime,ue=c.snapshot,Oe=function(e,t){var c=e.name,n=e.body,a=e.choices,r=e.startDate,s=e.startTime,i=e.endDate,o=e.endTime,j=e.snapshot,l={};c||(l.name=[t("%field% is required",{field:"Title"})]),n||(l.body=[t("%field% is required",{field:"Body"})]),a.length<2&&(l.choices=[t("Please create a minimum of %num% choices",{num:2})]);var b=a.some((function(e){return!e.value}));2===a.length&&b&&(l.choices=Array.isArray(l.choices)?[].concat(Object(V.a)(l.choices),[t("Choices must not be empty")]):l.choices=[t("Choices must not be empty")]),Object(X.default)(r)||(l.startDate=[t("Please select a valid date")]),Object(X.default)(s)||(l.startTime=[t("Please select a valid time")]),Object(X.default)(i)||(l.endDate=[t("Please select a valid date")]),Object(X.default)(o)||(l.endTime=[t("Please select a valid time")]);var d=_(r,s);return _(i,o)<d&&(l.endDate=Array.isArray(l.endDate)?[].concat(Object(V.a)(l.endDate),[t("End date must be after the start date")]):l.endDate=[t("End date must be after the start date")]),0===j&&(l.snapshot=[t("Invalid snapshot")]),l}(c,J),he=function(){var e=Object(j.a)(Object(i.a)().mark((function e(t){var c,n,a,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,p(!0),c=JSON.stringify(Object(o.a)(Object(o.a)({},Object(M.e)()),{},{type:v.f.PROPOSAL,payload:{name:se,body:ie,snapshot:ue,start:_(je,le),end:_(be,de),choices:oe.filter((function(e){return e.value})).map((function(e){return e.value})),metadata:Object(M.d)(),type:"single-choice"}})),e.next=6,Object(k.c)(G,K,c);case 6:if(!(n=e.sent)){e.next=16;break}return a={address:K,msg:c,sig:n},e.next=11,Object(M.i)(a);case 11:r=e.sent,W("/voting/proposal/".concat(r.ipfsHash)),$(J("Proposal created!")),e.next=17;break;case 16:te(J("Error"),J("Unable to sign payload"));case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.error(e.t0),p(!1);case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),xe=function(e,t){n((function(c){return Object(o.a)(Object(o.a)({},c),{},Object(s.a)({},e,t))})),F((function(t){return Object(o.a)(Object(o.a)({},t),{},Object(s.a)({},e,!0))}))},pe=function(e){return function(t){xe(e,t)}},me=Object(b.useMemo)((function(){return{hideIcons:K===ee.a?[]:["guide","fullscreen","preview","side-by-side","image"]}}),[K]);return Object(b.useEffect)((function(){Q>0&&n((function(e){return Object(o.a)(Object(o.a)({},e),{},{snapshot:Q})}))}),[Q,n]),Object(E.jsxs)(w.a,{py:"40px",children:[Object(E.jsx)(d.j,{mb:"48px",children:Object(E.jsxs)(d.k,{children:[Object(E.jsx)(I.a,{to:"/",children:J("Home")}),Object(E.jsx)(I.a,{to:"/voting",children:J("Voting")}),Object(E.jsx)(d.sb,{children:J("Make a Proposal")})]})}),Object(E.jsx)("form",{onSubmit:he,children:Object(E.jsxs)(Y.a,{children:[Object(E.jsxs)(d.j,{children:[Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(H,{htmlFor:"name",children:J("Title")}),Object(E.jsx)(d.O,{id:"name",name:"name",value:se,scale:"lg",onChange:function(e){var t=e.currentTarget,c=t.name,n=t.value;xe(c,n)},required:!0}),Oe.name&&z.name&&Object(E.jsx)(R,{errors:Oe.name})]}),Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(H,{htmlFor:"body",children:J("Content")}),Object(E.jsx)(d.sb,{color:"textSubtle",mb:"8px",children:J("Tip: write in Markdown!")}),Object(E.jsx)(re,{id:"body",name:"body",onTextChange:function(e){xe("body",e)},value:ie,options:me,required:!0}),Oe.body&&z.body&&Object(E.jsx)(R,{errors:Oe.body})]}),ie&&Object(E.jsx)(d.j,{mb:"24px",children:Object(E.jsxs)(d.p,{children:[Object(E.jsx)(d.s,{children:Object(E.jsx)(d.K,{as:"h3",scale:"md",children:J("Preview")})}),Object(E.jsx)(d.q,{p:"0",px:"24px",children:Object(E.jsx)(P.a,{children:ie})})]})}),Object(E.jsx)(U,{choices:oe,onChange:function(e){xe("choices",e)}}),Oe.choices&&z.choices&&Object(E.jsx)(R,{errors:Oe.choices})]}),Object(E.jsx)(d.j,{children:Object(E.jsxs)(d.p,{children:[Object(E.jsx)(d.s,{children:Object(E.jsx)(d.K,{as:"h3",scale:"md",children:J("Actions")})}),Object(E.jsxs)(d.q,{children:[Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(L,{children:J("Start Date")}),Object(E.jsx)(S.a,{name:"startDate",onChange:pe("startDate"),selected:je,placeholderText:"YYYY/MM/DD"}),Oe.startDate&&z.startDate&&Object(E.jsx)(R,{errors:Oe.startDate})]}),Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(L,{children:J("Start Time")}),Object(E.jsx)(S.c,{name:"startTime",onChange:pe("startTime"),selected:le,placeholderText:"00:00"}),Oe.startTime&&z.startTime&&Object(E.jsx)(R,{errors:Oe.startTime})]}),Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(L,{children:J("End Date")}),Object(E.jsx)(S.a,{name:"endDate",onChange:pe("endDate"),selected:be,placeholderText:"YYYY/MM/DD"}),Oe.endDate&&z.endDate&&Object(E.jsx)(R,{errors:Oe.endDate})]}),Object(E.jsxs)(d.j,{mb:"24px",children:[Object(E.jsx)(L,{children:J("End Time")}),Object(E.jsx)(S.c,{name:"endTime",onChange:pe("endTime"),selected:de,placeholderText:"00:00"}),Oe.endTime&&z.endTime&&Object(E.jsx)(R,{errors:Oe.endTime})]}),K&&Object(E.jsxs)(d.I,{alignItems:"center",mb:"8px",children:[Object(E.jsx)(d.sb,{color:"textSubtle",mr:"16px",children:J("Creator")}),Object(E.jsx)(d.Q,{href:Object(T.g)(K,"address"),children:Object(D.a)(K)})]}),Object(E.jsxs)(d.I,{alignItems:"center",mb:"16px",children:[Object(E.jsx)(d.sb,{color:"textSubtle",mr:"16px",children:J("Snapshot")}),Object(E.jsx)(d.Q,{href:Object(T.g)(ue,"block"),children:ue})]}),K?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(d.l,{type:"submit",width:"100%",isLoading:h,endIcon:h?Object(E.jsx)(d.g,{spin:!0,color:"currentColor"}):null,disabled:!m()(Oe),mb:"16px",children:J("Publish")}),Object(E.jsxs)(d.sb,{color:"failure",as:"p",mb:"4px",children:[J("You need at least %count% voting power to publish a proposal.",{count:ee.f})," "]}),Object(E.jsx)(d.l,{scale:"sm",type:"button",variant:"text",onClick:ne,p:0,children:J("Check voting power")})]}):Object(E.jsx)(B.a,{width:"100%",type:"button"})]})]})})]})})]})}},836:function(e,t,c){"use strict";var n,a=c(11),r=c(84),s=c(5),i=Object(s.e)(r.b)(n||(n=Object(a.a)(["\n  color: ",";\n"])),(function(e){return e.theme.colors.primaryBright}));t.a=i}}]);
//# sourceMappingURL=21.70eab7e0.chunk.js.map